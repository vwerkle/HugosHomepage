<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Results | SMTM Dness</title>
    <style>
        :root {
            --win-green: #2ecc71;
            --loss-red: #e74c3c;
            --pending-gray: #f8f9fa;
            --primary-blue: #3498db;
            --gold: #f1c40f;
        }

        body {
            font-family: 'Inter', -apple-system, sans-serif;
            background-color: #f0f2f5;
            margin: 0;
            padding: 20px;
        }

        .container { max-width: 1000px; margin: 0 auto; }

        /* Leaderboard Cards */
        .leaderboard-summary {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }
        .leader-card {
            background: white;
            padding: 15px 20px;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.05);
            text-align: center;
            min-width: 120px;
            border-bottom: 4px solid transparent;
            transition: transform 0.2s;
        }
        .leader-card.gold { border-bottom-color: var(--gold); transform: translateY(-5px); }
        .leader-name { font-size: 0.9rem; font-weight: 600; color: #7f8c8d; display: block; }
        .leader-score { font-size: 1.8rem; font-weight: 800; color: #2c3e50; }

        /* Table Styling */
        .table-wrapper {
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0,0,0,0.08);
        }

        .grid-table {
            border-collapse: collapse;
            width: 100%;
            font-size: 13px;
        }

        /* Sticky Headers */
        .grid-table thead {
            position: sticky;
            top: 0;
            z-index: 10;
            background: #2c3e50;
            color: white;
        }

        .grid-table th {
            padding: 15px 10px;
            font-weight: 600;
            border-bottom: 2px solid rgba(0,0,0,0.1);
        }

        .grid-table td {
            padding: 12px 10px;
            border-bottom: 1px solid #edf2f7;
            text-align: center;
        }

        .label-col {
            background: #f8f9fa;
            font-weight: bold;
            color: #34495e;
            text-align: left !important;
            padding-left: 20px !important;
            width: 140px;
        }

        /* Win/Loss Logic */
        .win { color: white; background-color: var(--win-green) !important; font-weight: bold; }
        .loss { color: white; background-color: var(--loss-red) !important; font-weight: bold; }
        .pending { background-color: transparent; }
        
        .hidden-pick {
            color: #bdc3c7;
            font-style: italic;
            background-color: #fdfdfd !important;
        }

        /* Separator Rows */
        .day-separator {
            background-color: #34495e;
            color: white;
            font-size: 11px;
            text-transform: uppercase;
            letter-spacing: 1px;
            font-weight: bold;
        }

        .leader-highlight {
            background-color: #3e5871 !important; /* Slightly lighter than the dark header */
            position: relative;
        }
        
        .crown-icon { font-size: 1.2em; }

        .nav-back {
            display: inline-block;
            margin-top: 20px;
            color: #3498db;
            text-decoration: none;
            font-weight: 600;
        }
    </style>
</head>
<body>

<div class="container">
    <div class="leaderboard-summary">
        {% for user, score in sorted_leaderboard %}
        <div class="leader-card {% if user in leaders %}gold{% endif %}">
            <span class="leader-name">{{ user }} {% if user in leaders %}ðŸ‘‘{% endif %}</span>
            <span class="leader-score">{{ score }}</span>
            <div style="font-size: 0.7rem; color: #bdc3c7;">TOTAL WINS</div>
        </div>
        {% endfor %}
    </div>

    <div class="table-wrapper">
        <table class="grid-table">
            <thead>
                <tr>
                    <th>Date / Slot</th>
                    {% for user in usernames %}
                        <th class="{% if user in leaders %}leader-highlight{% endif %}">
                            {{ user }} 
                            {% if user in leaders %}<span>ðŸ‘‘</span>{% endif %}
                            <br><small style="font-weight: normal; opacity: 0.8;">{{ user_totals[user] }} Wins</small>
                        </th>
                    {% endfor %}
                </tr>
            </thead>
            <tbody>
                {% for day in table_data %}
                    <tr class="day-separator">
                        <td colspan="{{ usernames|length + 1 }}" style="padding: 5px 20px;">
                            Entries for {{ day.date }}
                        </td>
                    </tr>
                    {% for slot in day.slots %}
                    <tr>
                        <td class="label-col">Slot {{ loop.index }}</td>
                        {% for user in usernames %}
                            {% set p = slot.users[user] %}
                            <td class="{{ p.result }} {% if 'HIDDEN' in p.info %}hidden-pick{% endif %}">
                                {{ p.info }}
                            </td>
                        {% endfor %}
                    </tr>
                    {% endfor %}
                {% endfor %}
            </tbody>
        </table>
    </div>

    <a href="{{ url_for('dness_hub') }}" class="nav-back">&larr; Back to Hub</a>
</div>

</body>
</html>